---
title: 2.5 初识作用域与命名空间
---

## 语句与作用域

### 声明语句与作用域
在 C++ 中，一个名字在被声明引入之前，是无效的。

```cpp
a = 1; // 错误：a 在这里是无效的

int a = 0; // 声明并创建一个整数类型的对象 a
```
在上面的例子中，`a` 在被声明之前是无效的，所以第一行代码是错误的。只有在 `a` 被声明之后，`a` 才是有效的。


### 复合语句与作用域
在前面我们已经讲过了[复合语句](./statements.md#复合语句)，复合语句的另一个重要作用是**引入作用域**。在复合语句内部声明的名称，只在复合语句内部有效。例如：

```cpp
int a = 1;
{
    int b = 2;
    a = 1; // 在复合语句内部，可以访问外部的名称
}
b = 3; // 错误：在复合语句外部，b 已经不可见
```
在上面的例子中，`b` 是在复合语句内部声明的，所以在复合语句外部是不可见的。这样的机制可以避免名称冲突，也可以提高程序的可读性。


### `for` 语句与作用域

在[`for` 语句](./statements.md#for-语句)中，`for` 语句的初始化部分中声明的名称，只在 `for` 语句内部有效。例如：
```cpp
for (int i = 0; i < 10; ++i) 
    a += i; // i 在这里是可见的
// i 在这里是不可见的
```

如果 `for` 语句的循环体是一个复合语句，其内部也对 `for` 的初始化部分声明的名称是可见的。例如：
```cpp
for (int i = 0; i < 10; ++i) {
    int a = 0;
    a += i; // i 在这里是可见的
}
// 在这里，a 和 i 都是不可见的
```

### 选择语句与作用域

在[`if` 语句](./statements.md#if-语句)、[`switch` 语句](./statements.md#switch-语句)中，在选择条件里可以写一个声明语句，这个声明的名称只在选择语句内部有效。

例如，在 `if` 语句提到了一个例子：
```cpp
if (int a = 1; a > b) max = a;
else max = b;
```
这和下面的代码是等价的：
```cpp
{
    int a = 1;
    if (a > b) max = a;
    else max = b;
}
```
从作用域的角度来说也是等价的，`a` 只在 `if` 语句内部有效。提到的等价代码中，加入 `{}` 组成复合语句正好描述了这个作用域的关系。

类似的，`switch` 语句选择条件中的声明也只在 `switch` 语句内部有效。例如：
```cpp
switch (int b = 2; a) {
    case 1: as = b; break;
    case 2: as = b * 4; break;
    default: as = 0;
}
```
这和下面的代码是等价的：
```cpp
{
    int b = 2;
    switch (a) {
        case 1: as = b; break;
        case 2: as = b * 4; break;
        default: as = 0;
    }
}
```

## 不同的作用域与重复的名称

在不同的作用域中，可以使用相同的名称。例如：
```cpp
int a = 1;
{
    int a = 2;
    a += 1; // 在这里，a 是内部的 a
}
{
    int a = 3;
    a += 1; // 在这里，a 是另一个内部的 a
}
// 在这里，a 是最外部的 a，值为 1
```

## 初识命名空间

::: caution TODO: 补充内容
:::